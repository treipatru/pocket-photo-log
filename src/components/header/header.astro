---
import { apiClient } from "@/lib/api/api-client";
import HeaderLink from "@/components/header/header-link.astro";
import AdminMenu from "@/components/header/admin-menu.astro";

const { isAuthenticated } = Astro.locals;
const displayLogin = !isAuthenticated && import.meta.env.DEV;

const articles = await apiClient.collection("pages").getFullList({
	sort: "name",
});
---

<header class="flex flex-row items-center justify-center">
	<nav
		class="menu menu-sm menu-horizontal rounded-box uppercase flex items-center gap-x-4"
	>
		<HeaderLink href="/" label="Home" />

		{
			articles.map((article) => (
				<HeaderLink href={`/pages/${article.slug}`} label={article.name} />
			))
		}

		{displayLogin && <HeaderLink href="/auth/login" label="Login" />}

		{isAuthenticated && <AdminMenu />}
	</nav>
</header>
