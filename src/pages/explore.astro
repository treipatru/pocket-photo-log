---
import { pocketClient } from "@/services/pocket/pocket-client";
import BlogLayout from "@/layouts/blog-layout.astro";
import Hero from "@/components/hero.astro";
import ExploreTags from "@/components/explore/explore-tags";
import ExploreYears from "@/components/explore/explore-years";

const tags = await pocketClient.collection("tags_with_posts").getFullList({
	sort: "-post_count",
});
const years = await pocketClient.collection("posts_per_year").getFullList({
	sort: "-year",
});

const cameras = tags.filter((tag) => tag.name.startsWith("camera:"));
const countries = tags.filter((tag) => tag.name.startsWith("co:"));
const places = tags.filter((tag) => tag.name.startsWith("pl:"));
const sets = tags.filter((tag) => tag.name.startsWith("set:"));
---

<BlogLayout>
	<Hero slot="hero" subtitle="explore" />

	<div class="flex flex-col gap-y-12">
		<ExploreTags tags={sets} title="Sets" tagCategory="set" />

		<ExploreYears years={years.map((y) => y.year).filter((y) => y !== null)} />

		<ExploreTags tags={places} title="Places" tagCategory="pl" />

		<ExploreTags tags={countries} title="Countries" tagCategory="co" />

		<ExploreTags tags={cameras} title="Cameras" tagCategory="camera" />
	</div>
</BlogLayout>
